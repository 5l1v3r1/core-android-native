#include <stdio.h>
#include <stdlib.h>
#include <unistd.h>
#include <stdio.h>
#include <string.h>
#include <sys/system_properties.h>
#include "log.h"
#include "check.h"

unsigned char mako[] = "\xec\x3e\xd6\x81\xf5\xfb\xff"; // "mako"
unsigned char m7[] = "\x2a\x85\xad\x49\x27"; // "m7"
unsigned char hammer[] = "\xa5\x56\xf9\x75\x4c\x48\x48\x40\x7b\x75\x40\x4c\x41"; // "hammerhead"
unsigned char grouper[] = "\x84\xd8\x5b\x63\x16\x1b\x11\x14\x61\x16"; // "grouper"
unsigned char huawei[] = "\xd8\x09\xd9\x83\xff\xfd\xf8\xf7\x9f\xf8\xf8"; // "Y530-U00"
unsigned char g2[] = "\x5a\x09\x51\x4f\x78"; // "g2"

unsigned char prop[] = "\x61\xff\x8e\xed\xf2\xb1\xfd\xec\xf8\xf3\xfb\xb1\xef\xed\xf2\xfb\xec\xfe\xeb"; // "ro.build.product"

unsigned char *device_list[] = {
  mako,
  m7,
  hammer,
  grouper,
  huawei,
  g2
};

int check_device() {
  char value[256];
  int supported = 0, i = 0;

  __system_property_get(deobfuscate(prop), value);


  for(i = 0; i < (sizeof(device_list)/4); i++) {
    if(strstr(deobfuscate(device_list[i]), value)) {
      LOGD("[CHECK] Found supported device %s\n", deobfuscate(device_list[i]));
      supported = 1;
      break;
    }
  }
  
  return supported;
}
